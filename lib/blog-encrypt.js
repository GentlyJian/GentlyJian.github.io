function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){function r(o,a){try{var u=t[o](a),i=u.value}catch(e){return void n(e)}if(!u.done)return Promise.resolve(i).then(function(e){r("next",e)},function(e){r("throw",e)});e(i)}return r("next")})}}var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(e){return void 0===e?"undefined":_typeof2(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":_typeof2(e)};!function(){"use strict";function e(e){return new Uint8Array(e.match(/[\da-f]{2}/gi).map(function(e){return parseInt(e,16)}))}function t(e){for(var t=e.length,n=0,r=new Array,o=0;o<t;){var a=e.codePointAt(o);a<128?(r[n++]=a,o++):a>127&&a<2048?(r[n++]=a>>6|192,r[n++]=63&a|128,o++):a>2047&&a<65536?(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=63&a|128,o++):(r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=63&a|128,o+=2)}return new Uint8Array(r)}function n(e){if("object"!==(void 0===e?"undefined":_typeof(e))||null===e||"number"!=typeof e.byteLength)throw new TypeError("Expected input to be an ArrayBuffer");for(var t,n=new Uint8Array(e),r="",o=0;o<n.length;o++)t=n[o].toString(16),r+=1===t.length?"0"+t:t;return r}function r(e){var t=new TextEncoder;return f.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveKey","deriveBits"])}function o(e){return f.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:m.buffer,iterations:1024},e,{name:"HMAC",hash:"SHA-256",length:256},!0,["verify"])}function a(e){return f.subtle.deriveKey({name:"PBKDF2",hash:"SHA-256",salt:m.buffer,iterations:1024},e,{name:"AES-CBC",length:256},!0,["decrypt"])}function u(e){return f.subtle.deriveBits({name:"PBKDF2",hash:"SHA-256",salt:d.buffer,iterations:512},e,128)}var i=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.createElement("script"),r=["type","text","src","crossorigin","defer","referrerpolicy"],r.forEach(function(e){t[e]&&(n[e]=t[e])}),e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=document.createElement("div"),n.innerHTML=t,n.querySelectorAll("script").forEach(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=t,e.next=3,i(t);case 3:e.t1=e.sent,e.t0.replaceWith.call(e.t0,e.t1);case 5:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()),e.abrupt("return",n);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),s=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(n,r){var o,a,u,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return o=new TextEncoder,a=o.encode(r),u=e(x),t.next=5,f.subtle.verify({name:"HMAC",hash:"SHA-256"},n,u,a);case 5:return i=t.sent,console.log("Verification result: "+i),i||(alert(v),console.log(v+", got ",u," but proved wrong.")),t.abrupt("return",i);case 9:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}(),l=function(){var t=_asyncToGenerator(regeneratorRuntime.mark(function t(n,r,o){var a,u,i=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e(w),t.next=3,f.subtle.decrypt({name:"AES-CBC",iv:r},n,a.buffer).then(function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,a,u,l,f;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=new TextDecoder,r=n.decode(t),a=document.createElement("button"),a.textContent="Encrypt again",a.type="button",a.classList.add("hbe-button"),a.addEventListener("click",function(){window.localStorage.removeItem(y),window.location.reload()}),document.getElementById("hexo-blog-encrypt").style.display="inline",document.getElementById("hexo-blog-encrypt").innerHTML="",e.t0=document.getElementById("hexo-blog-encrypt"),e.next=12,c(r);case 12:if(e.t1=e.sent,e.t0.appendChild.call(e.t0,e.t1),document.getElementById("hexo-blog-encrypt").appendChild(a),document.querySelectorAll("img").forEach(function(e){e.getAttribute("data-src")&&!e.src&&(e.src=e.getAttribute("data-src"))}),u=document.getElementById("toc-div"),u&&(u.style.display="inline"),(l=document.getElementsByClassName("toc-div-class"))&&l.length>0)for(f=0;f<l.length;f++)l[f].style.display="inline";return e.next=22,s(o,r);case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){return alert(g),console.log(e),!1});case 3:return u=t.sent,t.abrupt("return",u);case 5:case"end":return t.stop()}},t,this)}));return function(e,n,r){return t.apply(this,arguments)}}(),f=window.crypto||window.msCrypto,p=window.localStorage,y="hexo-blog-encrypt:#"+window.location.pathname,m=t("hexo-blog-encrypt的作者们都是大帅比!"),d=t("hexo-blog-encrypt是地表最强Hexo加密插件!"),h=document.getElementById("hexo-blog-encrypt"),g=h.dataset.wpm,v=h.dataset.whm,b=h.getElementsByTagName("script").hbeData,w=b.innerText,x=b.dataset.hmacdigest;!function(){var t=this,i=JSON.parse(p.getItem(y));if(i){console.log("Password got from localStorage("+y+"): ",i);var c=e(i.iv).buffer,s=i.dk,m=i.hmk;f.subtle.importKey("jwk",s,{name:"AES-CBC",length:256},!0,["decrypt"]).then(function(e){f.subtle.importKey("jwk",m,{name:"HMAC",hash:"SHA-256",length:256},!0,["verify"]).then(function(t){l(e,c,t).then(function(e){e||p.removeItem(y)})})})}h.addEventListener("keydown",function(){var e=_asyncToGenerator(regeneratorRuntime.mark(function e(i){var c,s,m,d,h;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!i.isComposing&&13!==i.keyCode){e.next=15;break}return c=document.getElementById("hbePass").value,e.next=4,r(c);case 4:return s=e.sent,e.next=7,o(s);case 7:return m=e.sent,e.next=10,a(s);case 10:return d=e.sent,e.next=13,u(s);case 13:h=e.sent,l(d,h,m).then(function(e){console.log("Decrypt result: "+e),e&&f.subtle.exportKey("jwk",d).then(function(e){f.subtle.exportKey("jwk",m).then(function(t){var r={dk:e,iv:n(h),hmk:t};p.setItem(y,JSON.stringify(r))})})});case 15:case"end":return e.stop()}},e,t)}));return function(t){return e.apply(this,arguments)}}())}()}();